<!DOCTYPE html>
<html>
<head>
  <title>Objection.lol Assets</title>
  <style>
    .content-block {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
      margin: 30px auto;
      color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div class="content-block">
    <h1>Objection.lol Assets</h1>
    <ul id="fileList"></ul>
  </div>

  <script>
fetch('filelist.json')
  .then(response => response.json())
  .then(files => {
    // Group files by folder (path before last slash)
    const groups = {};
    files.forEach(file => {
      const folder = file.path.substring(0, file.path.lastIndexOf('/')) || 'root';
      if (!groups[folder]) groups[folder] = [];
      groups[folder].push(file);
    });

    // Sort groups by folder name
    const sortedFolders = Object.keys(groups).sort();

    const ul = document.getElementById('fileList');

    sortedFolders.forEach(folder => {
      // Add header for folder
      const header = document.createElement('h2');
      header.textContent = folder;
      ul.appendChild(header);

      // Sort files alphabetically by name in the group
      groups[folder].sort((a, b) => a.name.localeCompare(b.name));

      groups[folder].forEach(file => {
        const li = document.createElement('li');

        const a = document.createElement('a');
        a.href = '/' + file.path;
        a.textContent = file.name;
        a.target = '_blank'; // open in new tab
        li.appendChild(a);

        const btn = document.createElement('button');
        btn.textContent = 'Copy Link';
        btn.style.marginLeft = '10px';
		btn.onclick = () => {
  navigator.clipboard.writeText(window.location.origin + '/' + file.path)
    .then(() => {
      // Create or reuse a span for feedback
      let feedback = btn.nextSibling;
      if (!feedback || !feedback.classList || !feedback.classList.contains('copy-feedback')) {
        feedback = document.createElement('span');
        feedback.classList.add('copy-feedback');
        feedback.style.marginLeft = '10px';
        feedback.style.color = 'green';
        btn.parentNode.insertBefore(feedback, btn.nextSibling);
      }
      feedback.textContent = 'Copied!';
      // Remove the feedback text after 2 seconds
      setTimeout(() => {
        feedback.textContent = '';
      }, 2000);
    })
    .catch(() => {
      // Similar feedback for failure
      let feedback = btn.nextSibling;
      if (!feedback || !feedback.classList || !feedback.classList.contains('copy-feedback')) {
        feedback = document.createElement('span');
        feedback.classList.add('copy-feedback');
        feedback.style.marginLeft = '10px';
        feedback.style.color = 'red';
        btn.parentNode.insertBefore(feedback, btn.nextSibling);
      }
      feedback.textContent = 'Failed to copy!';
      setTimeout(() => {
        feedback.textContent = '';
      }, 2000);
    });
		};
		
        li.appendChild(btn);

        ul.appendChild(li);
      });
    });
  })
  .catch(e => console.error('Failed to load filelist.json', e));
</script>
</body>
</html>